@if (modalService.currentModal()) {
<div
  class="modal-overlay"
  (click)="closeModal()"
  [class.open]="!isClosing()"
  [class.closing]="isClosing()"
>
  <div
    class="modal-content"
    (click)="$event.stopPropagation()"
    [class.open]="!isClosing()"
    [class.closing]="isClosing()"
  >
    <div class="modal-header">
      <h2>{{ getModalTitle() }}</h2>
      <button class="close-btn" (click)="closeModal()">âœ•</button>
    </div>
    <div class="modal-body">
      @switch (modalService.currentModal()) {
      <!-- Modals (pages) -->
      @case ('upgrades') {
      <app-upgrades />
      } @case ('achievements') {
      <app-achievements />
      } @case ('skins') {
      <app-skins />
      } @case ('options') {
      <app-options />
      } @case ('debug') {
      <app-debug-menu />
      } @case ('news') {
      <app-news />
      }

      <!-- Modals reales (componentes) -->
      @case ('username') {
      <div class="flex flex-col items-center p-6 space-y-4">
        <p class="text-center text-balance text-lg text-amber-950">
          {{ 'user.usernamePrompt' | transloco }}
        </p>

        <app-input
          [value]="desiredName()"
          (valueChange)="desiredName.set($event)"
          [loading]="usernameLoading()"
          [message]="usernameMessage()"
          (submit)="setUsername()"
          [buttonText]="'user.confirm' | transloco"
          [loadingText]="'user.checking' | transloco"
          [type]="'text'"
        ></app-input>
      </div>

      } @case ('leaderboard') {
      <app-leaderboard [mode]="'full'" />
      } @case ('confirm-dialog') {
      <div class="confirm-body">
        <p>{{ modalService.confirmDialog()?.message }}</p>
      </div>

      <div
        class="confirm-actions"
        [class.single-button]="!modalService.confirmDialog()?.cancelText"
      >
        @if (modalService.confirmDialog()?.cancelText) {
        <app-button variant="primary" (click)="cancelAction()">
          {{ modalService.confirmDialog()?.cancelText }}
        </app-button>
        }

        <app-button variant="primary" (click)="confirmAction()">
          {{ modalService.confirmDialog()?.confirmText }}
        </app-button>
      </div>
      } }
    </div>
  </div>
</div>
}
