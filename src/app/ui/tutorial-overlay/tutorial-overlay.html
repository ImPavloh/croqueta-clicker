<div class="tutorial-overlay">
  <div class="tutorial-panel" role="dialog" aria-modal="true">
    <div class="tutorial-header">
      <h2>{{ steps[currentIndex()].titleKey | transloco }}</h2>
      <div class="header-controls">
        <div class="step-indicator">{{ currentIndex() + 1 }} / {{ steps.length }}</div>
        <div class="progress-bar">
          <div
            class="progress-fill"
            [style.width.%]="((currentIndex() + 1) / steps.length) * 100"
          ></div>
        </div>
        <div class="close-btn">
          <app-button
            variant="control"
            (click)="close()"
            size="sm"
            class="close-button-custom"
            aria-label="{{ 'tutorial.overlay.close' | transloco }}"
          >
            Ã—
          </app-button>
        </div>
      </div>
    </div>
    <div class="tutorial-body" [class.fade]="fading()">
      <div class="tutorial-text">
        <div class="step-image">
          <img
            [src]="steps[currentIndex()].image || '/assets/croquetita/croquetita.webp'"
            alt="{{ steps[currentIndex()].titleKey | transloco }}"
            loading="lazy"
          />
        </div>
        <p class="text-center text-balance">{{ steps[currentIndex()].bodyKey | transloco }}</p>

        <div class="nav-buttons">
          <app-button
            variant="primary"
            (click)="prev()"
            [disabled]="currentIndex() === 0"
            size="md"
          >
            {{ 'tutorial.overlay.prev' | transloco }}
          </app-button>
          <app-button [variant]="isLast ? 'golden' : 'primary'" (click)="next()" size="md">
            {{
              isLast
                ? ('tutorial.overlay.finish_button' | transloco)
                : ('tutorial.overlay.next' | transloco)
            }}
          </app-button>
        </div>
      </div>
    </div>
  </div>
</div>
